SELECT 
    query_parameterized_hash,
    COUNT(*) as query_count,
    AVG(total_elapsed_time) as mean_elapsed_time,
    STDDEV(total_elapsed_time) as std_elapsed_time,
    MAX(total_elapsed_time) as max_elapsed_time,
    MIN(total_elapsed_time) as min_elapsed_time,
    AVG(bytes_scanned)
FROM SNOWFLAKE.ACCOUNT_USAGE.QUERY_HISTORY
WHERE query_parameterized_hash IN (
'46ee97ba2b7340ebbe80e1bca4e91a91',
'42822b83d52a4be7dab9ef53c2baa535',
'8eafb29e8ad5dc9e78d5358de61ab62c',
'060c9314e5b4d8a3fa58da28af991810',
'8b16365bfa5c621a1cc9be5bc3d59810',
'50233327f792120dca94c8e5d6e937ce',
'7bdc4fed524e7be999dcd7a14326b2d0',
'5661d40ecff5427dad69947f121f2d84',
'bf59b2ff73aa09a56c8634ce83f346c1',
'a76a78dd50859fe61f8f52791b4de47d',
'6e740cb9d673f14bc6bc7b4d3a77b42d',
'60195202172a509209e3bfcd6c051555',
'2855f630fb7c40615d2a6d10078bd4d3',
'f6ffcd14102204d737c0ffcd8c67ba30',
'5c898895ab4278436fc45f641f8d4af2',
'a193363576fdeb948131e5891827ec0c',
'4339d037e3675da68e701089dda23331',
'445fe9ac6a139c116203f6b918538b0e',
'71a50232609bef034d681708bd69a97a',
'd6e705327f09970c87ebc2ef3bf14445',
'2636a705a31bad5e8a77998c66f6fb7d',
'25b8b954703217e8d96757128a3ce6fb',
'99da341f250de7717467cacde01614c5',
'276f3998d3a6be4811ad1b22444357f8',
'8c653fd64f2e288632b5b35ebe67987a',
'7ccd3c620d63b83f5fd9df2c1f852821',
'95db8751cfbcb1062331dbbcfb9737ac',
'6f1d3a68b6b01fb8aeb3686d5f57850f',
'01d22e3bd48f98b9bd5b03742443e030',
'0cba956924300c3717db5c3584127da0',
'13dc75026a9b3de093e6d6ddabd79db3',
'552fc16887c3064c9d13c9fe4a2cabab',
'47785fd3f4d674661ba35d6977db836c',
'9a2c9ab187511b024b5683f7c2089973',
'4c2009bfb51310d0785985e83ab69f1a',
'cabf0f16d7dbe3b1180729c8e9abc73f',
'ef4f203d87704cd7a51c140c6ff010e1',
'2ac7aa5cd494bd4ece18b69f783a0a83',
'1f5c15932cd40afd30f8fbf0efd6df93',
'3a5d617bd7925952b5bdc7567b4c16c8',
'fbf057675a1e284a20d9d86b230329aa',
'e650f557e9bf84f435ec10769a1e3eec',
'3257f0c79880842473fe292d27662df0',
'7d0f79b89524be9a72424b95cafbe22f',
'7cda999feb43e7705006803f9a6f7c84',
'8563c02a951c338742d05409300a03fe',
'031c72ee9273ca91a8528ebcfba57538',
'ab87f36304d072f3dea5c9e5163c3ca0'
)
AND DATE_TRUNC('day', start_time) >= CURRENT_DATE() - 30
GROUP BY query_parameterized_hash
ORDER BY mean_elapsed_time DESC;
