Bag of words. 

Bayes rule applied to documents and classes. For a document d and class c: 
    P(c|d) = ( P(d|c) * P(c) ) / P(D) 

First get prior probabilities, so positives over negatives 
    select data:label, count(data:label) from yelp_review_testing where data:label = 0 or data:label = 4 group by data:label;

WITH extracted_text AS (
    SELECT 
        data:text::STRING AS text_content
    FROM YELP_REVIEW_TESTING
),
split_words AS (
    SELECT 
        text_content,
        TRIM(LOWER(value)) AS word
    FROM extracted_text,
    LATERAL FLATTEN(INPUT => SPLIT(text_content, ' '))
    WHERE TRIM(value) != ''
)
SELECT 
    word,
    COUNT(*) AS word_count
FROM split_words
GROUP BY word
ORDER BY word_count DESC;